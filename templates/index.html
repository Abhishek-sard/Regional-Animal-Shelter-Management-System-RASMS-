{% extends "layout.html" %}
{% block content %}
<div class="jumbotron text-center shadow">
    <h1 class="display-4"><i class="fas fa-paw">RASMS Dashboard</i></h1>
    <p class="lead">Regional Animal Shelter Management System</p>
    <hr class="my-4" style="border-color: rgba(255,255,255,0.3);">
    <p>Managing {{shelters|length}} shelters across South Australia</p>
</div>

<div class="row text-center mb-4">
    <div class="col-md-4">
        <div class="card stats-card shadow-sm">
            <div class="card-body">
                <div class="display-4 text-secondary"><i class="fas fa-home"></i></div>
                <h5 class="card-title text-muted mt-2">Total Shelters</h5>
                <h2 class="card-text-dark">{{shelters|length}}</h2>
            </div>
        </div>
    </div>

   <div class="col-md-4">
        <div class="card stats-card shadow-sm" style="border-left-color: var(--accent-color);">
            <div class="card-body">
                <div class="display-4 text-accent"><i class="fas fa-heart"></i></div>
                <h5 class="card-title text-muted mt-2">Total Adoptions</h5>
                <h2 class="card-text text-success">{{ total_adopted }}</h2>
            </div>
        </div>
    </div>
     <div class="col-md-4">
        <div class="card stats-card shadow-sm">
            <div class="card-body">
                <div class="display-4 text-primary"><i class="fas fa-dollar-sign"></i></div>
                <h5 class="card-title text-muted mt-2">Total Revenue</h5>
                <h2 class="card-text text-primary">${{ total_revenue }}</h2>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card shadow-sm h-100">
            <div class="card-header bg-white">
                <h5 class="m-0">Adoption Revenue per Shelter</h5>
            </div>
            <div class="card-body">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card shadow-sm h-100">
            <div class="card-header bg-white">
                <h5 class="m-0">Animals Housed per Shelter</h5>
            </div>
            <div class="card-body">
                <canvas id="animalChart"></canvas>
            </div>
        </div>
    </div>
</div>

<h3 class="mt-4 mb-3"><i class="fas fa-list"></i> Shelter Overview</h3>
<div class="table-responsive bg-white p-3 rounded shadow-sm">
    <table class="table table-hover align-middle">
        <thead class="table-light">
            <tr>
                <th>Shelter Name</th>
                <th>Location</th>
                <th>Animals</th>
                <th>Revenue</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for shelter in shelters %}
            <tr>
                <td class="fw-bold">{{ shelter.name }}</td>
                <td><i class="fas fa-map-marker-alt text-danger"></i> {{ shelter.location }}</td>
                <td><span class="badge bg-secondary">{{ shelter.animals|length }}</span></td>
                <td class="text-success fw-bold">${{ shelter.revenue }}</td>
                <td>
                    {% if shelter.animals|length > 0 %}
                    <span class="badge bg-success">Active</span>
                    {% else %}
                    <span class="badge bg-warning text-dark">Empty</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    // Data for Revenue Chart
    const ctxRevenue = document.getElementById('revenueChart').getContext('2d');
    new Chart(ctxRevenue, {
        type: 'bar',
        data: {
            labels: [{% for s in shelters %}"{{ s.name }}",{% endfor %}],
        datasets: [{
            label: 'Revenue ($)',
            data: [{% for s in shelters %}{{ s.revenue }}, {% endfor %}],
        backgroundColor: 'rgba(26, 188, 156, 0.6)',
        borderColor: 'rgba(26, 188, 156, 1)',
        borderWidth: 1
            }]
        },
        options: { responsive: true, maintainAspectRatio: false }
    });

    // Data for Animal Count Chart
    const ctxAnimal = document.getElementById('animalChart').getContext('2d');
    new Chart(ctxAnimal, {
        type: 'doughnut',
        data: {
            labels: [{% for s in shelters %}"{{ s.name }}",{% endfor %}],
        datasets: [{
            data: [{% for s in shelters %}{{ s.animals | length }}, {% endfor %}],
        backgroundColor: [
        '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
        '#FF9F40', '#E7E9ED', '#71B37C', '#2c3e50', '#8e44ad'
    ]
            }]
        },
        options: { responsive: true, maintainAspectRatio: false }
    });
</script>
{% endblock %}
